---
layout: post
title: 贝叶斯理论
---
在介绍贝叶斯定理之前，我们先看wiki上的一个例子

>一所学校里面有 60% 的男生，40% 的女生。男生总是穿长裤，女生则一半穿长裤一半穿裙子。有了这些信息之后我们可以容易地计算“随机选取一个学生，他（她）穿长裤的概率和穿裙子的概率是多大”。然而，假设你走在校园中，迎面走来一个穿长裤的学生（很不幸的是你高度近视，你只看得见他（她）穿的是否长裤，而无法确定他（她）的性别），你能够推断出他（她）是男生的概率是多大吗？

我们用P(boy)表示一个学生是男生的概率，P(pants|boy)表示一个男生穿长裤的条件概率，P(pants|girl)表示一个女生穿长裤的条件概率。那么一个穿长裤的学生是男生的概率可以表示为

$$ P(boy|pants) = \frac{P(pants|boy) P(boy)}{P(pants|boy) P(boy) + P(pants|girl) P(girl)} $$

上式中分子其实就是P(pants, boy)的联合概率，分母是P(pants)的全概率，因此上式可以简化成

$$ P(boy|pants) = \frac{P(pants, boy)}{P(pants)} $$

更一般地，我们用A, B表示这两个事件，有

$$ P(A|B) = \frac{P(AB)}{P(B)} $$

### 贝叶斯定理
我们对上面的式子稍加变形，可以得到

$$ P(AB) = P(A|B) P(B) $$

同理可以得到

$$ P(AB) = P(B|A) P(A) $$

于是有

$$
P(A|B) P(B) = P(B|A) P(A) \Rightarrow P(A|B) = P(A) \frac{P(B|A)}{P(B)}
$$

这就是著名的贝叶斯定理。其中P(A)叫做先验概率(Prior probability), 表示我们可以事先能过观察或推断得到的一个概率，比如上例中学校里一个学生是男生的概率。P(A|B)叫做后验概率(Posterior probability)，既事件B发生后，我们对事件A的概率的重新评估，比如上例中我们看到一个穿长裤的学生，那么这个学生是男生的概率。
